<FCGI_INCLUDE FILE=header.html>
<FCGI_INCLUDE FILE=langjs>	
<script language='javascript'>
var ThisPage="";	
document.write('<script src="../js/version.js?ver='+Math.random()+'"></s'+'cript>');	
</script>
<script language='javascript'>
	
document.onreadystatechange = newF;
function newF()
{
	if(document.readyState == "complete")
	{
		document.getElementById("div_1").style.display = "none";
	}
}	

function DoF5Jump()
{
	Relocate('do?id=7&id=1');
}
var PageRefDesURL='do?id=7&id=1';
function LoadLang()
{
	var tmp = Security+"-"+Basic;
	LoadCommonResources(tmp);
	document.getElementById("tWebPasswordModify").innerHTML = WebPasswordModify;
	document.getElementById("tUserName").innerHTML = UserName;
	document.getElementById("tCurrentPasswd").innerHTML = CurrentPassword;
	document.getElementById("tNewPasswd").innerHTML = NewPassword;
	document.getElementById("tConfirmPasswd").innerHTML = ConfirmPassword;
	document.getElementById("tSetResult").innerHTML = SetResult;
	document.getElementById("tSessionTimeOut").innerHTML = ("undefined" != typeof(SessionTimeOut))?SessionTimeOut:"Session TimeOut";
	document.getElementById("tSessionTimeOutValue").innerHTML = ("undefined" != typeof(SessionTimeOutValue))?SessionTimeOutValue:"Session TimeOut Value";
	
}

function LoadCfg()
{
	LoadLang();
	
	var f1 = document.forms["body_form"];
	var f2 = document.forms["hiddenValForm"];
	
	var arrUserNameList = f2.hcUserNameList.value.split(SplitSymbol);	
	for(var i=0; i < f2.hcUserNum.value; i++)
	{
		document.getElementById("cUserName").options.add(new Option(arrUserNameList[i], arrUserNameList[i]));
	}
	
	DelayShow();
	SubLoadCfg();
}

function SubLoadCfg()
{
	var f1 = document.forms["body_form"];
	var f2 = document.forms["hiddenValForm"];
	var curSetPwdStatus = document.getElementById("cSetPwdStatus").innerHTML;
	ClearPasswords();
	
	document.getElementById('trOfSetPwdStatus').style.display = "none";
	if(f2.hcSetPwdStatus.value == 0)	{}
	else
	{
		if(1 == f2.hcSetPwdStatus.value && "" == curSetPwdStatus)
		{
			document.getElementById('trOfSetPwdStatus').style.display = "";
			document.getElementById('cSetPwdStatus').innerHTML = SetPasswordSuccessNotice;
			setTimeout("Relocate('/fcgi/do?id=7&id=1')", 1000);
		}
		else
		{
			if(""== curSetPwdStatus)
			{document.getElementById('trOfSetPwdStatus').style.display = "";
			document.getElementById('cSetPwdStatus').innerHTML = PasswordIncorrectWarning;
			}
		}
	}
	
	f1.cUserName.value = f2.hcUserName.value;
	f1.cSessionTimeOutValue.value = f2.hcSessionTimeOutValue.value;
	
	ResetAllInputColor();
	f1.cUserName.style.backgroundColor = "";
}

function ClearPasswords()
{
	var f1 = document.forms["body_form"];
	f1.cCurrentPasswd.value = "";
	f1.cNewPasswd.value = "";
	f1.cConfirmPasswd.value = "";
}

function CheckCommitData()
{
	var f1 = document.forms["body_form"];
	var f2 = document.forms["hiddenValForm"];
	var f3 = document.forms["submit_form"];
	var strSubmData = "";
	var ErrFlag = false;
	
	if("" == f1.cUserName.value)
	{
		SetInputBGColor("cUserName");
		ErrFlag = true;
	}
	if(!NotContainInvalid(f1.cCurrentPasswd.value, "cCurrentPasswd"))
	{
		SetInputBGColor("cCurrentPasswd");
		ErrFlag = true;
	}
	if(!NotContainInvalid(f1.cNewPasswd.value, "cNewPasswd"))
	{
		SetInputBGColor("cNewPasswd");
		ErrFlag = true;
	}
	if(!NotContainInvalid(f1.cConfirmPasswd.value, "cConfirmPasswd"))
	{
		SetInputBGColor("cConfirmPasswd");
		ErrFlag = true;
	}
	if(f2.hcSessionTimeOutValue.value != f1.cSessionTimeOutValue.value)
	{
		if(!CheckRangeOfNumber(f1.cSessionTimeOutValue.value, 60, 14400))
		{
			SetInputBGColor("cSessionTimeOutValue");
			ErrFlag = true;
		}
		strSubmData = strSubmData + "&cSessionTimeOutValue=" + f1.cSessionTimeOutValue.value;
	}
	
	if(true == ErrFlag)
	{
		return DataCheckResult;
	}	
	// generated by code
	if(f1.cNewPasswd.value != f1.cConfirmPasswd.value)
	{
		ClearPasswords();
		alert(ConfirmPasswordWarning);
		ErrFlag = true;
	}
	
	f3.action = "";
	if("" != f1.cCurrentPasswd.value || "" != f1.cNewPasswd.value || "" != f1.cConfirmPasswd.value)
	{
		strSubmData += "&cUserName=";
		strSubmData += f1.cUserName.value;
		strSubmData += "&cCurrentPasswd=";
		strSubmData += f1.cCurrentPasswd.value;
		strSubmData += "&cNewPasswd=";
		strSubmData += f1.cNewPasswd.value;
	}

	if(false == isASCIICase(f1.cNewPasswd.value) )
	{
		ErrFlag = true;
		SetInputBGColor("cNewPasswd");
		SetInputBGColor("cConfirmPasswd");
		alert(WarningASCCaseAllowed); 
	}
	if(true == ErrFlag)
	{
		return DataCheckResult;
	}
	return strSubmData;
}

function CheckDataChanged(destURL)
{
	var f1 = document.forms["body_form"];
	var f2 = document.forms["hiddenValForm"];
	var dataChangedWarnFlag = 0;
	
	if( (!PwdKeyFirst[0] && "" != f1.cCurrentPasswd.value) ||
			(!PwdKeyFirst[1] && "" != f1.cNewPasswd.value) ||
			(!PwdKeyFirst[2] && "" != f1.cConfirmPasswd.value) )
	{
		dataChangedWarnFlag = 1;
	}
	if(f2.hcSessionTimeOutValue.value != f1.cSessionTimeOutValue.value) 
	{
		dataChangedWarnFlag = true;		
	}

	if( 0 == dataChangedWarnFlag)
	{
		Relocate(destURL);
		return false;
	}
	if(!confirm(SavePageConfirm))
	{
		return false;
	}
	else
	{
		Relocate(destURL);
		return false;
	}
}

function OnSubmit()
{
	var f3 = document.forms["submit_form"];
	var strSubmData = CheckCommitData();
	if(DataCheckResult == strSubmData)
	{
		return;
	}
	strSubmData = "begin&Operation=ModifyPwd" + strSubmData + "&SubmitData=end";
	f3.SubmitData.value = strSubmData;
	DoForm3Submit(f3);
}
$(function() {
	SetPageMenuAction("#aMenu7", "tMenu71");
});

</script>

<body onLoad="LoadCfg()">
<div id="div_1" style="width:105%; height:105%; z-index:999; position:absolute; background-color:#FFFFFF;"></div>
<div class="headline"></div>
<div class="phone1">
	<FCGI_INCLUDE FILE=top.html>
	<div class="main">
		<FCGI_INCLUDE FILE=left.html>
		<div id="midWhole" class="mid">
			<div class="mid_top"><label id="tInnerTitle"></label></div>
			<div class="mid_cont" id="mid_cont1">
			</div>			
    	<div class="mid_cont" id="mid_cont2" style="display:none">
<form name="body_form">    		
			<div class="div_border">
			<div class="div_head"><label id='tWebPasswordModify'>Web Password Modify</label></div>
			<table class="table_style">		
				<tr id="trOfSetPwdStatus" style="display:none"><td class="Second_td"><label id='tSetResult'></label></td> <td class="Third_td" style="color:red"><label id='cSetPwdStatus'></label></td></tr>
				<tr><td class="Second_td"><label id='tUserName'></label></td> <td class="Third_td"><select id='cUserName' name='cUserName' onChange ="ClearPasswords()"></select></td></tr>
				<tr><td class="Second_td"><label id='tCurrentPasswd'></label></td><td class="Third_td"><input type="password" name="cCurrentPasswd" value="" id="1" oncontextmenu="KeyFirstDelete(this.id, 0)" onKeyDown="KeyFirstDelete(this.id, 0)" /></td></tr>
				<tr><td class="Second_td"><label id='tNewPasswd'></label></td> <td class="Third_td"><input type="password" name="cNewPasswd" value="" id="2" oncontextmenu="KeyFirstDelete(this.id, 1)" onKeyDown="KeyFirstDelete(this.id, 1)" /></td></tr>
				<tr><td class="Second_td"><label id='tConfirmPasswd'></label></td> <td class="Third_td"><input type="password" name="cConfirmPasswd" value="" id="3" oncontextmenu="KeyFirstDelete(this.id, 2)" onKeyDown="KeyFirstDelete(this.id, 2)" /></td></tr>
			</table>		
			</div>
				
			<div class="div_border" id="SecurityB_divSessionTimeOut">
			<div class="div_head"><label id='tSessionTimeOut'></label></div>
			<table class="table_style">			
				<tr><td class="Second_td"><label id='tSessionTimeOutValue'></label></td> <td class="Third_td"><input type="text" id="cSessionTimeOutValue" name="cSessionTimeOutValue" />(60~14400s)</td></tr>
			</table>
			</div>
					
</form>
<form method="post" name="submit_form" id="submit_form" action="">
				<div align="center">
				<table width="70%" style="text-align:center">
          <br/>
          <input type="hidden" name="SubmitData" value="">
          <tr><td><input id="PageSubmit" name="PageSubmit" class="Nice_Btn" type="button" value="Submit" onClick ="OnSubmit()"></td>
        <td><input id="PageCancel" name="PageCancel" class="Nice_Btn" type="button" value="Cancel" onClick ="SubLoadCfg()"></td></tr>
        </table>  
        </div>
</form>
			</div>
		</div>
	<FCGI_INCLUDE FILE=help.html>
	<FCGI_INCLUDE FILE=rightMir.html>
	</div>
</div>
</form>
<FCGI_INCLUDE FILE=bottom.html>